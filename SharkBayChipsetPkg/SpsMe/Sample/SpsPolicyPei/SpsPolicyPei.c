/** @file



;******************************************************************************
;* Copyright (c) 2013 - 2014, Insyde Software Corp. All Rights Reserved.
;*
;* You may not reproduce, distribute, publish, display, perform, modify, adapt,
;* transmit, broadcast, present, recite, release, license or otherwise exploit
;* any part of this publication in any form, by any means, without the prior
;* written permission of Insyde Software Corporation.
;*
;******************************************************************************
*/

#include "SpsPolicyPei.h"

UINT8 PchChipsetInitTableWbg_A0[] = {
  0x5F, 0xDA, //U16 CRC-16
  0x23, 0x00, //U16 Version
  0x6C,       //U8  NumEntries;
  // Hsio Entries
  // Offset   Value                 EP
  0x40,0xE1, 0xA6,0x05,0x08,0x00, 0xEB,
  0x40,0xE3, 0xA6,0x05,0x08,0x00, 0xEB,
  0x40,0xC5, 0xA6,0x05,0x08,0x00, 0xEB,
  0x40,0xC7, 0xA6,0x05,0x08,0x00, 0xEB,
  0x44,0xE1, 0x94,0x03,0x04,0x00, 0xEB,
  0x44,0xE3, 0x94,0x03,0x04,0x00, 0xEB,
  0x44,0xC5, 0x94,0x03,0x04,0x00, 0xEB,
  0x44,0xC7, 0x94,0x03,0x04,0x00, 0xEB,
  0x40,0x83, 0x96,0x05,0x08,0x00, 0xE9,
  0x40,0x83, 0x96,0x05,0x08,0x00, 0xEA,
  0x44,0x83, 0x94,0x03,0x04,0x00, 0xE9,
  0x44,0x83, 0x94,0x03,0x04,0x00, 0xEA,
  0x0C,0x80, 0x50,0xAB,0x02,0x0E, 0xEB,
  0x0C,0x80, 0x50,0xAB,0x02,0x0E, 0xE9,
  0x00,0xE1, 0x89,0x5F,0x0B,0x0F, 0xEB,
  0x00,0xE3, 0x89,0x5F,0x0B,0x0F, 0xEB,
  0x00,0xC5, 0x89,0x5F,0x0B,0x0F, 0xEB,
  0x00,0xC7, 0x89,0x5F,0x0B,0x0F, 0xEB,
  0x00,0xE1, 0x89,0x5F,0x0B,0x0F, 0xE9,
  0x00,0xE3, 0x89,0x5F,0x0B,0x0F, 0xE9,
  0x00,0xE5, 0x89,0x5F,0x0B,0x0F, 0xE9,
  0x00,0xE7, 0x89,0x5F,0x0B,0x0F, 0xE9,
  0x00,0xE9, 0x89,0x5F,0x0B,0x0F, 0xE9,
  0x00,0xEB, 0x89,0x5F,0x0B,0x0F, 0xE9,
  0x00,0xED, 0x89,0x5F,0x0B,0x0F, 0xE9,
  0x00,0xEF, 0x89,0x5F,0x0B,0x0F, 0xE9,
  0x00,0xE1, 0x89,0x5F,0x0B,0x0F, 0xEA,
  0x00,0xE3, 0x89,0x5F,0x0B,0x0F, 0xEA,
  0x7C,0xE1, 0x00,0x3F,0x40,0x3D, 0xEB,
  0x7C,0xE3, 0x00,0x3F,0x40,0x3D, 0xEB,
  0x7C,0xC5, 0x00,0x3F,0x40,0x3D, 0xEB,
  0x7C,0xC7, 0x00,0x3F,0x40,0x3D, 0xEB,
  0x7C,0xED, 0x00,0x3F,0x00,0x4F, 0xE9,
  0x7C,0xEF, 0x00,0x3F,0x00,0x4F, 0xE9,
  0x7C,0xF1, 0x00,0x3F,0x00,0x4F, 0xE9,
  0x7C,0xF3, 0x00,0x3F,0x00,0x4F, 0xE9,
  0x7C,0xD5, 0x00,0x3F,0x00,0x4F, 0xE9,
  0x7C,0xD7, 0x00,0x3F,0x00,0x4F, 0xE9,
  0x78,0xED, 0x84,0x1B,0x00,0x00, 0xE9,
  0x78,0xEF, 0x84,0x1B,0x00,0x00, 0xE9,
  0x78,0xF1, 0x84,0x1B,0x00,0x00, 0xE9,
  0x78,0xF3, 0x84,0x1B,0x00,0x00, 0xE9,
  0x78,0xD5, 0x84,0x1B,0x00,0x00, 0xE9,
  0x78,0xD7, 0x84,0x1B,0x00,0x00, 0xE9,
  0xCC,0xE1, 0x04,0x43,0x35,0x00, 0xEB,
  0xCC,0xE3, 0x04,0x43,0x35,0x00, 0xEB,
  0xCC,0xC5, 0x04,0x43,0x35,0x00, 0xEB,
  0xCC,0xC7, 0x04,0x43,0x35,0x00, 0xEB,
  0x90,0xE0, 0x55,0x51,0x3E,0x2B, 0xE9,
  0x90,0xE2, 0x55,0x51,0x3E,0x2B, 0xE9,
  0x90,0xE4, 0x55,0x51,0x3E,0x2B, 0xE9,
  0x90,0xE6, 0x55,0x51,0x3E,0x2B, 0xE9,
  0x90,0xE8, 0x55,0x51,0x3E,0x2B, 0xE9,
  0x90,0xEA, 0x55,0x51,0x3E,0x2B, 0xE9,
  0x90,0xEC, 0x55,0x51,0x3E,0x2B, 0xE9,
  0x90,0xEE, 0x55,0x51,0x3E,0x2B, 0xE9,
  0x90,0xE0, 0x55,0x51,0x3E,0x2B, 0xEA,
  0x90,0xE2, 0x55,0x51,0x3E,0x2B, 0xEA,
  0x90,0x82, 0x55,0x51,0x3E,0x2B, 0xEA,
  0x8C,0xE0, 0x46,0x20,0x78,0x0C, 0xE9,
  0x8C,0xE2, 0x46,0x20,0x78,0x0C, 0xE9,
  0x8C,0xE4, 0x46,0x20,0x78,0x0C, 0xE9,
  0x8C,0xE6, 0x46,0x20,0x78,0x0C, 0xE9,
  0x8C,0xE8, 0x46,0x20,0x78,0x0C, 0xE9,
  0x8C,0xEA, 0x46,0x20,0x78,0x0C, 0xE9,
  0x8C,0xEC, 0x46,0x20,0x78,0x0C, 0xE9,
  0x8C,0xEE, 0x46,0x20,0x78,0x0C, 0xE9,
  0x8C,0xE0, 0x46,0x20,0x78,0x0C, 0xEA,
  0x8C,0xE2, 0x46,0x20,0x78,0x0C, 0xEA,
  0x8C,0x82, 0x46,0x20,0x78,0x0C, 0xEA,
  0x30,0xE0, 0x00,0x0F,0x00,0x00, 0xEB,
  0x30,0xE2, 0x00,0x0F,0x00,0x00, 0xEB,
  0x30,0xC4, 0x00,0x0F,0x00,0x00, 0xEB,
  0x30,0xC6, 0x00,0x0F,0x00,0x00, 0xEB,
  0x30,0xE0, 0x00,0x0F,0x00,0x00, 0xE9,
  0x30,0xE2, 0x00,0x0F,0x00,0x00, 0xE9,
  0x30,0xE4, 0x00,0x0F,0x00,0x00, 0xE9,
  0x30,0xE6, 0x00,0x0F,0x00,0x00, 0xE9,
  0x30,0xE8, 0x00,0x0F,0x00,0x00, 0xE9,
  0x30,0xEA, 0x00,0x0F,0x00,0x00, 0xE9,
  0x30,0xEC, 0x00,0x0F,0x00,0x00, 0xE9,
  0x30,0xEE, 0x00,0x0F,0x00,0x00, 0xE9,
  0x30,0xE0, 0x00,0x0F,0x00,0x00, 0xEA,
  0x30,0xE2, 0x00,0x0F,0x00,0x00, 0xEA,
  0x30,0xE4, 0x00,0x0F,0x00,0x00, 0xEA,
  0x30,0xE6, 0x00,0x0F,0x00,0x00, 0xEA,
  0x30,0xC8, 0x00,0x0F,0x00,0x00, 0xEA,
  0x30,0xCA, 0x00,0x0F,0x00,0x00, 0xEA,
  0xCC,0xE1, 0x04,0x43,0x35,0x00, 0xE9,
  0xCC,0xE3, 0x04,0x43,0x35,0x00, 0xE9,
  0xCC,0xE5, 0x04,0x43,0x35,0x00, 0xE9,
  0xCC,0xE7, 0x04,0x43,0x35,0x00, 0xE9,
  0xCC,0xE9, 0x04,0x43,0x35,0x00, 0xE9,
  0xCC,0xEB, 0x04,0x43,0x35,0x00, 0xE9,
  0xCC,0xED, 0x04,0x43,0x35,0x00, 0xE9,
  0xCC,0xEF, 0x04,0x43,0x35,0x00, 0xE9,
  0xCC,0xE1, 0x04,0x43,0x35,0x00, 0xEA,
  0xCC,0xE3, 0x04,0x43,0x35,0x00, 0xEA,
  0xCC,0xE5, 0x04,0x43,0x35,0x00, 0xEA,
  0xCC,0xE7, 0x04,0x43,0x35,0x00, 0xEA,
  0xCC,0xC9, 0x04,0x43,0x35,0x00, 0xEA,
  0xCC,0xCB, 0x04,0x43,0x35,0x00, 0xEA,
  0x2C,0xE0, 0x00,0x0A,0x00,0x0F, 0xEB,
  0x2C,0xE2, 0x00,0x0A,0x00,0x0F, 0xEB,
  0x2C,0xC4, 0x00,0x0A,0x00,0x0F, 0xEB,
  0x2C,0xC6, 0x00,0x0A,0x00,0x0F, 0xEB,
  0x2C,0x82, 0x00,0x0A,0x00,0x0F, 0xE9,
  0x2C,0x82, 0x00,0x0A,0x00,0x0F, 0xEA
};

UINT8 PchChipsetInitTableWbg_B0[] = {
  0x58, 0x66, //U16 CRC-16
  0x29, 0x31, //U16 Version
  0x26,       //U8  NumEntries;
  // HSIO Entries
  // Offset   Value                 EP
  0x2C,0xC0, 0x00,0x0A,0x00,0x0F, 0xEB,
  0x2C,0x82, 0x00,0x0A,0x00,0x0F, 0xE9,
  0x40,0xC1, 0x9C,0x05,0x88,0x00, 0xE9,
  0x98,0xC0, 0x41,0x3B,0x20,0x1F, 0xEB,
  0x98,0xC0, 0x41,0x3B,0x20,0x1F, 0xE9,
  0x98,0xC0, 0x41,0x3B,0x20,0x1F, 0xEA,
  0x2C,0x82, 0x00,0x0A,0x00,0x0F, 0xEA,
  0x30,0xC0, 0x00,0x0F,0x00,0x00, 0xEB,
  0x30,0xC0, 0x00,0x0F,0x00,0x00, 0xE9,
  0x94,0xC0, 0x55,0x60,0x40,0x47, 0xEB,
  0x30,0xC0, 0x00,0x0F,0x00,0x00, 0xEA,
  0x40,0x83, 0x9C,0x05,0x88,0x00, 0xEA,
  0x78,0xC1, 0x80,0x19,0x00,0x00, 0xEB,
  0x94,0xC0, 0x55,0x60,0x40,0x47, 0xE9,
  0x94,0xC0, 0x55,0x60,0x40,0x47, 0xEA,
  0x88,0xC0, 0x3A,0x98,0x80,0x55, 0xEB,
  0x78,0xC1, 0x80,0x19,0x00,0x00, 0xE9,
  0x88,0xC0, 0x3A,0x98,0x80,0x55, 0xE9,
  0x88,0x82, 0x3A,0x98,0x80,0x55, 0xEA,
  0x8C,0xC0, 0x46,0x20,0x78,0x0C, 0xEB,
  0x8C,0xC0, 0x46,0x20,0x78,0x0C, 0xE9,
  0x8C,0x82, 0x46,0x20,0x78,0x0C, 0xEA,
  0x78,0xC1, 0x80,0x19,0x00,0x00, 0xEA,
  0xCC,0xC1, 0x04,0x43,0x25,0x38, 0xE9,
  0xCC,0xC1, 0x04,0x43,0x25,0x38, 0xEB,
  0xCC,0xC1, 0x04,0x43,0x25,0x38, 0xEA,
  0x7C,0xC1, 0x00,0x24,0xA0,0x4E, 0xE9,
  0x7C,0xC1, 0x00,0x24,0xC0,0x3E, 0xEB,
  0x7C,0xC1, 0x00,0x24,0xC0,0x3E, 0xEA,
  0x40,0xC1, 0xAC,0x05,0x88,0x00, 0xEB,
  0x90,0xC0, 0x55,0x51,0x3E,0x2B, 0xEB,
  0x90,0xC0, 0x55,0x51,0x3E,0x2B, 0xE9,
  0x90,0x82, 0x55,0x51,0x3E,0x2B, 0xEA,
  0x08,0xC0, 0x00,0xA0,0x00,0xB0, 0xE9,
  0x08,0xC0, 0x00,0xA0,0x00,0xB0, 0xEA,
  0x44,0xC1, 0x94,0x03,0x84,0x00, 0xEB,
  0x44,0xC1, 0x94,0x03,0x84,0x00, 0xE9,
  0x44,0x83, 0x94,0x03,0x84,0x00, 0xEA
};

UINT8 PchChipsetInitTableLptH_B0[] = {
  0x79, 0x56, //U16 CRC-16
  0x23, 0x02, //U16 Version
  0x1A,       //U8 NumEntries
  // Hsio Entries
  // Offset   Value                 EP
  0x40,0xC1, 0xA6,0x05,0x08,0x00, 0xEB,
  0x44,0xC1, 0x94,0x03,0x04,0x00, 0xEB,
  0x40,0x83, 0x96,0x05,0x08,0x00, 0xE9,
  0x40,0x83, 0x96,0x05,0x08,0x00, 0xEA,
  0x44,0x83, 0x94,0x03,0x04,0x00, 0xE9,
  0x44,0x83, 0x94,0x03,0x04,0x00, 0xEA,
  0x0C,0x80, 0x50,0xAB,0x02,0x0E, 0xEB,
  0x0C,0x80, 0x50,0xAB,0x02,0x0E, 0xE9,
  0x00,0xC1, 0x89,0x5F,0x0B,0x0F, 0xEB,
  0x00,0xC1, 0x89,0x5F,0x0B,0x0F, 0xE9,
  0x7C,0xC1, 0x00,0x3F,0x40,0x3D, 0xEB,
  0x7C,0xC1, 0x00,0x3F,0x00,0x4F, 0xE9,
  0x78,0xC1, 0x84,0x1B,0x00,0x00, 0xE9,
  0xCC,0xC1, 0x04,0x43,0x35,0x00, 0xEB,
  0x90,0xC0, 0x55,0x51,0x3E,0x2B, 0xE9,
  0x90,0x82, 0x55,0x51,0x3E,0x2B, 0xEA,
  0x8C,0xC0, 0x46,0x20,0x78,0x0C, 0xE9,
  0x8C,0x82, 0x46,0x20,0x78,0x0C, 0xEA,
  0x30,0xC0, 0x00,0x0F,0x00,0x00, 0xEB,
  0x30,0xC0, 0x00,0x0F,0x00,0x00, 0xE9,
  0x30,0xC0, 0x00,0x0F,0x00,0x00, 0xEA,
  0xCC,0xC1, 0x04,0x43,0x35,0x00, 0xE9,
  0xCC,0xC1, 0x04,0x43,0x35,0x00, 0xEA,
  0x2C,0xC0, 0x00,0x0A,0x00,0x0F, 0xEB,
  0x2C,0x82, 0x00,0x0A,0x00,0x0F, 0xE9,
  0x2C,0x82, 0x00,0x0A,0x00,0x0F, 0xEA
};

UINT8 PchChipsetInitTableLptH_Cx[] = {
  0x1B, 0x18, //U16 CRC-16
  0x1F, 0x03, //U16 Version
  0x21,       //U8  NumEntries;
  // Hsio Entries
  // Offset   Value                 EP
  0x2C,0xC0, 0x00,0x0A,0x00,0x0F, 0xEB,
  0x2C,0x82, 0x00,0x0A,0x00,0x0F, 0xE9,
  0x40,0xC1, 0x9C,0x05,0x08,0x00, 0xE9,
  0x98,0xC0, 0x41,0x3B,0x20,0x1F, 0xEB,
  0x98,0xC0, 0x41,0x3B,0x20,0x1F, 0xE9,
  0x98,0xC0, 0x41,0x3B,0x20,0x1F, 0xEA,
  0x2C,0x82, 0x00,0x0A,0x00,0x0F, 0xEA,
  0x30,0xC0, 0x00,0x0F,0x00,0x00, 0xEB,
  0x30,0xC0, 0x00,0x0F,0x00,0x00, 0xE9,
  0x94,0xC0, 0x55,0x60,0x40,0x47, 0xEB,
  0x30,0xC0, 0x00,0x0F,0x00,0x00, 0xEA,
  0x40,0x83, 0x9C,0x05,0x08,0x00, 0xEA,
  0x78,0xC1, 0x80,0x19,0x00,0x00, 0xEB,
  0x94,0xC0, 0x55,0x60,0x40,0x47, 0xE9,
  0x94,0xC0, 0x55,0x60,0x40,0x47, 0xEA,
  0x88,0xC0, 0x3A,0x98,0x80,0x55, 0xEB,
  0x78,0xC1, 0x80,0x19,0x00,0x00, 0xE9,
  0x88,0xC0, 0x3A,0x98,0x80,0x55, 0xE9,
  0x88,0x82, 0x3A,0x98,0x80,0x55, 0xEA,
  0x8C,0xC0, 0x46,0x20,0x78,0x0C, 0xEB,
  0x8C,0xC0, 0x46,0x20,0x78,0x0C, 0xE9,
  0x8C,0x82, 0x46,0x20,0x78,0x0C, 0xEA,
  0x78,0xC1, 0x80,0x19,0x00,0x00, 0xEA,
  0xCC,0xC1, 0x04,0x43,0x25,0x38, 0xE9,
  0xCC,0xC1, 0x04,0x43,0x25,0x38, 0xEB,
  0xCC,0xC1, 0x04,0x43,0x25,0x38, 0xEA,
  0x7C,0xC1, 0x00,0x24,0xC0,0x3E, 0xE9,
  0x7C,0xC1, 0x00,0x24,0xC0,0x3E, 0xEB,
  0x7C,0xC1, 0x00,0x24,0xC0,0x3E, 0xEA,
  0x40,0xC1, 0xAC,0x05,0x08,0x00, 0xEB,
  0x90,0xC0, 0x55,0x51,0x3E,0x2B, 0xEB,
  0x90,0xC0, 0x55,0x51,0x3E,0x2B, 0xE9,
  0x90,0x82, 0x55,0x51,0x3E,0x2B, 0xEA
};

UINT8 PchChipsetInitTableLptH_Cx_161[] = {
  0x1C, 0x67, //U16 CRC-16
  0x26, 0x03, //U16 Version
  0x23,       //U8  NumEntries;
  // HSIO Entries
  // Offset   Value                 EP
  0x2C,0xC0, 0x00,0x0A,0x00,0x0F, 0xEB,
  0x2C,0x82, 0x00,0x0A,0x00,0x0F, 0xE9,
  0x40,0xC1, 0x9C,0x05,0x08,0x00, 0xE9,
  0x98,0xC0, 0x41,0x3B,0x20,0x1F, 0xEB,
  0x98,0xC0, 0x41,0x3B,0x20,0x1F, 0xE9,
  0x98,0xC0, 0x41,0x3B,0x20,0x1F, 0xEA,
  0x2C,0x82, 0x00,0x0A,0x00,0x0F, 0xEA,
  0x30,0xC0, 0x00,0x0F,0x00,0x00, 0xEB,
  0x30,0xC0, 0x00,0x0F,0x00,0x00, 0xE9,
  0x94,0xC0, 0x55,0x60,0x40,0x47, 0xEB,
  0x30,0xC0, 0x00,0x0F,0x00,0x00, 0xEA,
  0x40,0x83, 0x9C,0x05,0x08,0x00, 0xEA,
  0x78,0xC1, 0x80,0x19,0x00,0x00, 0xEB,
  0x94,0xC0, 0x55,0x60,0x40,0x47, 0xE9,
  0x94,0xC0, 0x55,0x60,0x40,0x47, 0xEA,
  0x88,0xC0, 0x3A,0x98,0x80,0x55, 0xEB,
  0x78,0xC1, 0x80,0x19,0x00,0x00, 0xE9,
  0x88,0xC0, 0x3A,0x98,0x80,0x55, 0xE9,
  0x88,0x82, 0x3A,0x98,0x80,0x55, 0xEA,
  0x8C,0xC0, 0x46,0x20,0x78,0x0C, 0xEB,
  0x8C,0xC0, 0x46,0x20,0x78,0x0C, 0xE9,
  0x8C,0x82, 0x46,0x20,0x78,0x0C, 0xEA,
  0x78,0xC1, 0x80,0x19,0x00,0x00, 0xEA,
  0xCC,0xC1, 0x04,0x43,0x25,0x38, 0xE9,
  0xCC,0xC1, 0x04,0x43,0x25,0x38, 0xEB,
  0xCC,0xC1, 0x04,0x43,0x25,0x38, 0xEA,
  0x7C,0xC1, 0x00,0x24,0xA0,0x4E, 0xE9,
  0x7C,0xC1, 0x00,0x24,0xC0,0x3E, 0xEB,
  0x7C,0xC1, 0x00,0x24,0xC0,0x3E, 0xEA,
  0x40,0xC1, 0xAC,0x05,0x08,0x00, 0xEB,
  0x90,0xC0, 0x55,0x51,0x3E,0x2B, 0xEB,
  0x90,0xC0, 0x55,0x51,0x3E,0x2B, 0xE9,
  0x90,0x82, 0x55,0x51,0x3E,0x2B, 0xEA,
  0x08,0xC0, 0x00,0x80,0x00,0xB0, 0xE9,
  0x08,0xC0, 0x00,0x80,0x00,0xB0, 0xEA
};

UINT8 PchChipsetInitTableLptH_Cx_162[] = {
  0x58, 0x66, //U16 CRC-16
  0x29, 0x03, //U16 Version
  0x26,       //U8  NumEntries;
  // HSIO Entries
  // Offset   Value                 EP
  0x2C,0xC0, 0x00,0x0A,0x00,0x0F, 0xEB,
  0x2C,0x82, 0x00,0x0A,0x00,0x0F, 0xE9,
  0x40,0xC1, 0x9C,0x05,0x88,0x00, 0xE9,
  0x98,0xC0, 0x41,0x3B,0x20,0x1F, 0xEB,
  0x98,0xC0, 0x41,0x3B,0x20,0x1F, 0xE9,
  0x98,0xC0, 0x41,0x3B,0x20,0x1F, 0xEA,
  0x2C,0x82, 0x00,0x0A,0x00,0x0F, 0xEA,
  0x30,0xC0, 0x00,0x0F,0x00,0x00, 0xEB,
  0x30,0xC0, 0x00,0x0F,0x00,0x00, 0xE9,
  0x94,0xC0, 0x55,0x60,0x40,0x47, 0xEB,
  0x30,0xC0, 0x00,0x0F,0x00,0x00, 0xEA,
  0x40,0x83, 0x9C,0x05,0x88,0x00, 0xEA,
  0x78,0xC1, 0x80,0x19,0x00,0x00, 0xEB,
  0x94,0xC0, 0x55,0x60,0x40,0x47, 0xE9,
  0x94,0xC0, 0x55,0x60,0x40,0x47, 0xEA,
  0x88,0xC0, 0x3A,0x98,0x80,0x55, 0xEB,
  0x78,0xC1, 0x80,0x19,0x00,0x00, 0xE9,
  0x88,0xC0, 0x3A,0x98,0x80,0x55, 0xE9,
  0x88,0x82, 0x3A,0x98,0x80,0x55, 0xEA,
  0x8C,0xC0, 0x46,0x20,0x78,0x0C, 0xEB,
  0x8C,0xC0, 0x46,0x20,0x78,0x0C, 0xE9,
  0x8C,0x82, 0x46,0x20,0x78,0x0C, 0xEA,
  0x78,0xC1, 0x80,0x19,0x00,0x00, 0xEA,
  0xCC,0xC1, 0x04,0x43,0x25,0x38, 0xE9,
  0xCC,0xC1, 0x04,0x43,0x25,0x38, 0xEB,
  0xCC,0xC1, 0x04,0x43,0x25,0x38, 0xEA,
  0x7C,0xC1, 0x00,0x24,0xA0,0x4E, 0xE9,
  0x7C,0xC1, 0x00,0x24,0xC0,0x3E, 0xEB,
  0x7C,0xC1, 0x00,0x24,0xC0,0x3E, 0xEA,
  0x40,0xC1, 0xAC,0x05,0x88,0x00, 0xEB,
  0x90,0xC0, 0x55,0x51,0x3E,0x2B, 0xEB,
  0x90,0xC0, 0x55,0x51,0x3E,0x2B, 0xE9,
  0x90,0x82, 0x55,0x51,0x3E,0x2B, 0xEA,
  0x08,0xC0, 0x00,0xA0,0x00,0xB0, 0xE9,
  0x08,0xC0, 0x00,0xA0,0x00,0xB0, 0xEA,
  0x44,0xC1, 0x94,0x03,0x84,0x00, 0xEB,
  0x44,0xC1, 0x94,0x03,0x84,0x00, 0xE9,
  0x44,0x83, 0x94,0x03,0x84,0x00, 0xEA
};

UINT8 PchChipsetInitTableLptH_Cx_180[] = {
  0x9D, 0x59, //U16 CRC-16
  0x2C, 0x03, //U16 Version
  0x29,       //U8  NumEntries;
  // HSIO Entries
  // Offset   Value                 EP
  0x2C,0xC0, 0x00,0x0A,0x00,0x0F, 0xEB,
  0x2C,0x82, 0x00,0x0A,0x00,0x0F, 0xE9,
  0x40,0xC1, 0x9C,0x05,0x88,0x00, 0xE9,
  0x98,0xC0, 0x41,0x3B,0x20,0x1F, 0xEB,
  0x98,0xC0, 0x41,0x3B,0x20,0x1F, 0xE9,
  0x98,0xC0, 0x41,0x3B,0x20,0x1F, 0xEA,
  0x2C,0x82, 0x00,0x0A,0x00,0x0F, 0xEA,
  0x30,0xC0, 0x00,0x0F,0x00,0x00, 0xEB,
  0x30,0xC0, 0x00,0x0F,0x00,0x00, 0xE9,
  0x94,0xC0, 0x55,0x60,0x40,0x47, 0xEB,
  0x30,0xC0, 0x00,0x0F,0x00,0x00, 0xEA,
  0x40,0x83, 0x9C,0x05,0x88,0x00, 0xEA,
  0x78,0xC1, 0x80,0x19,0x00,0x00, 0xEB,
  0x94,0xC0, 0x55,0x60,0x40,0x47, 0xE9,
  0x94,0xC0, 0x55,0x60,0x40,0x47, 0xEA,
  0x88,0xC0, 0x3A,0x98,0x80,0x55, 0xEB,
  0x78,0xC1, 0x80,0x19,0x00,0x00, 0xE9,
  0x88,0xC0, 0x3A,0x98,0x80,0x55, 0xE9,
  0x88,0x82, 0x3A,0x98,0x80,0x55, 0xEA,
  0x8C,0xC0, 0x46,0x20,0x78,0x0C, 0xEB,
  0x8C,0xC0, 0x46,0x20,0x78,0x0C, 0xE9,
  0x8C,0x82, 0x46,0x20,0x78,0x0C, 0xEA,
  0x78,0xC1, 0x80,0x19,0x00,0x00, 0xEA,
  0xCC,0xC1, 0x04,0x43,0x25,0x38, 0xE9,
  0xCC,0xC1, 0x04,0x43,0x25,0x38, 0xEB,
  0xCC,0xC1, 0x04,0x43,0x25,0x38, 0xEA,
  0x7C,0xC1, 0x00,0x24,0xA0,0x4E, 0xE9,
  0x7C,0xC1, 0x00,0x24,0xC0,0x3E, 0xEB,
  0x7C,0xC1, 0x00,0x24,0xC0,0x3E, 0xEA,
  0x40,0xC1, 0xAC,0x05,0x88,0x00, 0xEB,
  0x90,0xC0, 0x55,0x51,0x3E,0x2B, 0xEB,
  0x90,0xC0, 0x55,0x51,0x3E,0x2B, 0xE9,
  0x90,0x82, 0x55,0x51,0x3E,0x2B, 0xEA,
  0x08,0xC0, 0x00,0xA0,0x00,0xB0, 0xE9,
  0x08,0xC0, 0x00,0xA0,0x00,0xB0, 0xEA,
  0x44,0xC1, 0x94,0x03,0x84,0x00, 0xEB,
  0x44,0xC1, 0x94,0x03,0x84,0x00, 0xE9,
  0x44,0x83, 0x94,0x03,0x84,0x00, 0xEA,
  0x38,0xC0, 0x32,0x00,0xCE,0x38, 0xEB,
  0x38,0xC0, 0x32,0x00,0xCE,0x38, 0xE9,
  0x38,0xC0, 0x32,0x00,0xCE,0x38, 0xEA
};


VOID
PeiDumpSpsPolicy (
  IN SPS_POLICY_PPI                    *SpsPolicyPpi
  )
{
  UINT8                 Index;
  UINT8                 *ChipsetInitTable;
  UINTN                 MaxPStatesRatioNumber;

  Index = 0;
  MaxPStatesRatioNumber = sizeof(SpsPolicyPpi->HostInfo.PStatesRatio)/sizeof(SpsPolicyPpi->HostInfo.PStatesRatio[0]);

  DEBUG ((DEBUG_INFO, "\n"));
  DEBUG ((DEBUG_INFO, "[PEI SPS ME POLICY] INFO: SpsPolicyPpi (Address : 0x%x)\n", SpsPolicyPpi));
  DEBUG ((DEBUG_INFO, " |-Revision                  : 0x%x\n", SpsPolicyPpi->Revision));
  DEBUG ((DEBUG_INFO, " |-ME-BIOS Interface Version\n"));
  DEBUG ((DEBUG_INFO, " | |-Major Version           : 0x%x\n", SpsPolicyPpi->MeBiosIntfVer.Major));
  DEBUG ((DEBUG_INFO, " | |-Minor Version           : 0x%x\n", SpsPolicyPpi->MeBiosIntfVer.Minor));
  DEBUG ((DEBUG_INFO, " |-SkuSwitch\n"));
  DEBUG ((DEBUG_INFO, " | |-Silicon Enabled         : 0x%x\n", SpsPolicyPpi->SkuSwitch.SiliconEnabled));
  DEBUG ((DEBUG_INFO, " | |-NodeManager Enabled     : 0x%x\n", SpsPolicyPpi->SkuSwitch.NodeManagerEnabled));
  DEBUG ((DEBUG_INFO, " |-Message Switch\n"));
  DEBUG ((DEBUG_INFO, " | |-MeBiosInterfaceVersion  : 0x%x\n", SpsPolicyPpi->MsgSwitch.MeBiosInterfaceVersion));
  DEBUG ((DEBUG_INFO, " | |-Dynamic Fusing          : 0x%x\n", SpsPolicyPpi->MsgSwitch.DynamicFusing));
  DEBUG ((DEBUG_INFO, " | |-ICC Set Clock Enables   : 0x%x\n", SpsPolicyPpi->MsgSwitch.IccSetClockEnables));
  DEBUG ((DEBUG_INFO, " | |-ICC Set Spread Spectrum : 0x%x\n", SpsPolicyPpi->MsgSwitch.IccSetSpreadSpectrum));
  DEBUG ((DEBUG_INFO, " | |-Host Configuration      : 0x%x\n", SpsPolicyPpi->MsgSwitch.HostConfiguration));
  DEBUG ((DEBUG_INFO, " | |-HMRFPO GET STATUS       : 0x%x\n", SpsPolicyPpi->MsgSwitch.HmrfpoGetStatus));
  DEBUG ((DEBUG_INFO, " | |-HMRFPO LOCK             : 0x%x\n", SpsPolicyPpi->MsgSwitch.HmrfpoLock));
  DEBUG ((DEBUG_INFO, " | |-HMRFPO ENABLE           : 0x%x\n", SpsPolicyPpi->MsgSwitch.HmrfpoEnable));
  DEBUG ((DEBUG_INFO, " | |-End Of Post             : 0x%x\n", SpsPolicyPpi->MsgSwitch.EndOfPost));

  DEBUG ((DEBUG_INFO, " |-ICC Setting\n"));
  if (SpsPolicyPpi->MsgSwitch.IccSetClockEnables) {
    DEBUG ((DEBUG_INFO, " | |-ICC Clock Enables (SKip Response: 0x%x)\n", SpsPolicyPpi->IccSetting.IccClockEnablesSkipResponse));
    DEBUG ((DEBUG_INFO, " | | |-Data                  : 0x%08x\n", SpsPolicyPpi->IccSetting.IccClockEnables.UInt32));
  }

  if (SpsPolicyPpi->MsgSwitch.IccSetSpreadSpectrum) {
    DEBUG ((DEBUG_INFO, " | |-ICC Spread spectrum select (SKip Response: 0x%x)\n", SpsPolicyPpi->IccSetting.IccSpreadSpectrumSkipResponse));
    DEBUG ((DEBUG_INFO, " | | |-SSC1ModeSelect        : 0x%x\n", SpsPolicyPpi->IccSetting.IccSpreadSpectrum.Field.SSC1ModeSelect));
    DEBUG ((DEBUG_INFO, " | | |-SSC2ModeSelect        : 0x%x\n", SpsPolicyPpi->IccSetting.IccSpreadSpectrum.Field.SSC2ModeSelect));
    DEBUG ((DEBUG_INFO, " | | |-SSC3ModeSelect        : 0x%x\n", SpsPolicyPpi->IccSetting.IccSpreadSpectrum.Field.SSC3ModeSelect));
    DEBUG ((DEBUG_INFO, " | | |-SSC4ModeSelect        : 0x%x\n", SpsPolicyPpi->IccSetting.IccSpreadSpectrum.Field.SSC4ModeSelect));
    DEBUG ((DEBUG_INFO, " | | |-SSC5ModeSelect        : 0x%x\n", SpsPolicyPpi->IccSetting.IccSpreadSpectrum.Field.SSC5ModeSelect));
    DEBUG ((DEBUG_INFO, " | | |-SSC6ModeSelect        : 0x%x\n", SpsPolicyPpi->IccSetting.IccSpreadSpectrum.Field.SSC6ModeSelect));
    DEBUG ((DEBUG_INFO, " | | |-SSC7ModeSelect        : 0x%x\n", SpsPolicyPpi->IccSetting.IccSpreadSpectrum.Field.SSC7ModeSelect));
    DEBUG ((DEBUG_INFO, " | | |-SSC8ModeSelect        : 0x%x\n", SpsPolicyPpi->IccSetting.IccSpreadSpectrum.Field.SSC8ModeSelect));
  }

  if (SpsPolicyPpi->MsgSwitch.HostConfiguration) {
    DEBUG ((DEBUG_INFO, " |-Host Configuration Information\n"));
    DEBUG ((DEBUG_INFO, " | |-Capabilities            : 0x%x\n", SpsPolicyPpi->HostInfo.Capabilities));
    DEBUG ((DEBUG_INFO, " | |-PStatesNumber           : 0x%x\n", SpsPolicyPpi->HostInfo.PStatesNumber));
    DEBUG ((DEBUG_INFO, " | |-TStatesNumber           : 0x%x\n", SpsPolicyPpi->HostInfo.TStatesNumber));
    DEBUG ((DEBUG_INFO, " | |-MaxPower                : 0x%x\n", SpsPolicyPpi->HostInfo.MaxPower));
    DEBUG ((DEBUG_INFO, " | |-MinPower                : 0x%x\n", SpsPolicyPpi->HostInfo.MinPower));
    DEBUG ((DEBUG_INFO, " | |-ProcNumber              : 0x%x\n", SpsPolicyPpi->HostInfo.ProcNumber));
    DEBUG ((DEBUG_INFO, " | |-ProcCoresNumber         : 0x%x\n", SpsPolicyPpi->HostInfo.ProcCoresNumber));
    DEBUG ((DEBUG_INFO, " | |-ProcCoresEnabled        : 0x%x\n", SpsPolicyPpi->HostInfo.ProcCoresEnabled));
    DEBUG ((DEBUG_INFO, " | |-ProcThreadsEnabled      : 0x%x\n", SpsPolicyPpi->HostInfo.ProcThreadsEnabled));
    DEBUG ((DEBUG_INFO, " | |-TurboRatioLimit         : 0x%lx\n", SpsPolicyPpi->HostInfo.TurboRatioLimit));
    DEBUG ((DEBUG_INFO, " | |-PlatformInfo            : 0x%lx\n", SpsPolicyPpi->HostInfo.PlatformInfo));
    DEBUG ((DEBUG_INFO, " | |-Altitude                : 0x%x\n", SpsPolicyPpi->HostInfo.Altitude));
    for (Index = 0; Index < MaxPStatesRatioNumber; Index++) {
      DEBUG ((DEBUG_INFO, " | |-PStatesRatio[%02d]        : 0x%02x\n", Index, SpsPolicyPpi->HostInfo.PStatesRatio[Index]));
    }
  }

  if (SpsPolicyPpi->MeFwUpgradeConfig.UpgradeSupported) {
    DEBUG ((DEBUG_INFO, " |-MeFwUpgradeConfig\n"));
    DEBUG ((DEBUG_INFO, " | |-UpgradeSupported        : 0x%x\n", SpsPolicyPpi->MeFwUpgradeConfig.UpgradeSupported));
    DEBUG ((DEBUG_INFO, " | |-ProtectDescriptorRegion : 0x%x\n", SpsPolicyPpi->MeFwUpgradeConfig.ProtectDescriptorRegion));
    DEBUG ((DEBUG_INFO, " | |-ProtectMeRegion         : 0x%x\n", SpsPolicyPpi->MeFwUpgradeConfig.ProtectMeRegion));
    DEBUG ((DEBUG_INFO, " | |-ProtectGbeRegion        : 0x%x\n", SpsPolicyPpi->MeFwUpgradeConfig.ProtectGbeRegion));
    DEBUG ((DEBUG_INFO, " | |-ProtectPDRRegion        : 0x%x\n", SpsPolicyPpi->MeFwUpgradeConfig.ProtectPDRRegion));
    DEBUG ((DEBUG_INFO, " | |-ProtectDERRegion        : 0x%x\n", SpsPolicyPpi->MeFwUpgradeConfig.ProtectDERRegion));
    DEBUG ((DEBUG_INFO, " | |-SpiLock                 : 0x%x\n", SpsPolicyPpi->MeFwUpgradeConfig.SpiLock));
    DEBUG ((DEBUG_INFO, " | |-CmosIndexPort           : 0x%x\n", SpsPolicyPpi->MeFwUpgradeConfig.CmosIndexPort));
    DEBUG ((DEBUG_INFO, " | |-CmosDataPort            : 0x%x\n", SpsPolicyPpi->MeFwUpgradeConfig.CmosDataPort));
    DEBUG ((DEBUG_INFO, " | |-CmosOffset              : 0x%x\n", SpsPolicyPpi->MeFwUpgradeConfig.CmosOffset));
    DEBUG ((DEBUG_INFO, " | |-FactoryDefaultSize      : 0x%x\n", SpsPolicyPpi->MeFwUpgradeConfig.FactoryDefaultSize));
    DEBUG ((DEBUG_INFO, " | |-OperationImageSize      : 0x%x\n", SpsPolicyPpi->MeFwUpgradeConfig.OperationImageSize));
    DEBUG ((DEBUG_INFO, " | |-BlockMode               : 0x%x\n", SpsPolicyPpi->MeFwUpgradeConfig.BlockMode));
    DEBUG ((DEBUG_INFO, " | |-Downgrade               : 0x%x\n", SpsPolicyPpi->MeFwUpgradeConfig.Downgrade));
  }

  DEBUG ((DEBUG_INFO, "\n"));

  ChipsetInitTable = &SpsPolicyPpi->mPhyTableData[0];
  DEBUG ((DEBUG_INFO, "    (MPHY) mPhyChipsetInitTable[%d] = \n", SpsPolicyPpi->mPhyTableLen));
  DEBUG ((DEBUG_INFO, "      Ver=0x%04x CRC=0x%04X NumEntries=%d\n",
          *((UINT16*)&ChipsetInitTable[2]), *((UINT16*)&ChipsetInitTable[0]), ChipsetInitTable[4]));
  {
    int ii;
    UINT8* entry_ptr = &ChipsetInitTable[5];
    for (ii = 0; ii < ChipsetInitTable[4]; ii++) {
      DEBUG ((DEBUG_INFO, "      %02d: EP=0x%02X OFFSET=0x%04X VALUE=0x%08X\n",
              ii, entry_ptr[6],*((UINT16*)&entry_ptr[0]),*((UINT32*)&entry_ptr[2])));
      entry_ptr += 7;
    }
  }

  DEBUG ((DEBUG_INFO, "\n"));

  return;
}

/**
  Save SPS Policy in Hob.

  @param[in] SpsPolicyPpi         SPS Policy.

  @retval EFI_SUCCESS             Create SPS POlicy Hob successfully.
  @retval All other error conditions encountered result in an ASSERT.
**/
EFI_STATUS
SpsPolicySaveSpsPolicyHob (
  IN SPS_POLICY_PPI                    *SpsPolicyPpi
  )
{
  EFI_PEI_HOB_POINTERS       Hob;
  SPS_POLICY_HOB             *SpsPolicyHob;

  SpsPolicyHob = NULL;

  ///
  /// Create SPS Policy HOB
  ///
  Hob.Raw = GetFirstGuidHob (&gSpsPolicyHobGuid);
  if (Hob.Raw != NULL) {
    SpsPolicyHob = (SPS_POLICY_HOB *) GET_GUID_HOB_DATA (Hob);
  } else {
    SpsPolicyHob = (SPS_POLICY_HOB *) BuildGuidHob (&gSpsPolicyHobGuid, sizeof (SPS_POLICY_HOB));
    if (SpsPolicyHob == NULL) {
      return EFI_INVALID_PARAMETER;
    } else {
      ZeroMem (SpsPolicyHob, sizeof (SPS_POLICY_HOB));
    }
  }

  CopyMem (SpsPolicyHob, SpsPolicyPpi, sizeof (SPS_POLICY_HOB));

  return EFI_SUCCESS;
}

EFI_STATUS
SpsPolicyPeimEntry (
  IN       EFI_FFS_FILE_HEADER         *FfsHeader,
  IN CONST EFI_PEI_SERVICES            **PeiServices
  )
{
  EFI_STATUS                      Status;
  EFI_PEI_PPI_DESCRIPTOR          *SpsPolicyPpiDesc;
  SPS_POLICY_PPI                  *SpsPolicyPpi;
  EFI_PEI_READ_ONLY_VARIABLE2_PPI *Variable;
  UINTN                           VariableSize;
  SYSTEM_CONFIGURATION            SetupVariable;
  UINT8                           PchSteppingValue;
  UINT32                          Data32;

  DEBUG ((DEBUG_INFO, "[PEI SPS ME POLICY] INFO: SPS ME Policy PEI Entry\n"));

  SpsPolicyPpiDesc  = NULL;
  SpsPolicyPpi      = NULL;
  Variable          = NULL;
  VariableSize      = 0;

  /// Locate PeiVariable2 Ppi
  Status = PeiServicesLocatePpi (
             &gEfiPeiReadOnlyVariable2PpiGuid,
             0,
             NULL,
             (VOID **)&Variable
             );
  if (EFI_ERROR (Status)) {
    DEBUG ((DEBUG_ERROR, "[PEI SPS ME POLICY] ERROR: Locate ReadOnlyVariable2 PPI (%r)\n", Status));
    return Status;
  }

  VariableSize = sizeof (SYSTEM_CONFIGURATION);
  Status = Variable->GetVariable (
             Variable,
             SETUP_VARIABLE_NAME,
             &gSystemConfigurationGuid,
             NULL,
             &VariableSize,
             &SetupVariable
             );
  if (EFI_ERROR (Status)) {
    DEBUG ((DEBUG_ERROR, "[PEI SPS ME POLICY] ERROR: Get Setup Variable (%r)\n", Status));
    return Status;
  }

  ///
  /// Allocate memory for ME Policy PPI and Descriptor
  ///
  SpsPolicyPpiDesc = (EFI_PEI_PPI_DESCRIPTOR *) AllocateZeroPool (sizeof (EFI_PEI_PPI_DESCRIPTOR));
  if (SpsPolicyPpiDesc == NULL) {
    DEBUG ((DEBUG_ERROR, "[PEI SPS ME POLICY] ERROR: Allocate memory for SPS ME Policy PPI Descriptor fail\n"));
    return Status;
  }

  SpsPolicyPpi = (SPS_POLICY_PPI *) AllocateZeroPool (sizeof (SPS_POLICY_PPI));
  if (SpsPolicyPpi == NULL) {
    DEBUG ((DEBUG_ERROR, "[PEI SPS ME POLICY] ERROR: Allocate memory for SPS ME Policy PPI fail\n"));
    return Status;
  }

  ///
  /// Update ME Policy PPI Descriptor
  ///
  SpsPolicyPpiDesc->Flags = EFI_PEI_PPI_DESCRIPTOR_PPI | EFI_PEI_PPI_DESCRIPTOR_TERMINATE_LIST;
  SpsPolicyPpiDesc->Guid  = &gSpsPolicyPpiGuid;
  SpsPolicyPpiDesc->Ppi   = SpsPolicyPpi;

  ///
  /// SPS ME Policy initialize
  ///
  ///
  /// Update Revision number
  ///
  SpsPolicyPpi->Revision = SPS_POLICY_REVISION;

  ///
  /// Update ME-BIOS Interface Version
  ///
  SpsPolicyPpi->MeBiosIntfVer.Major = 1;
  SpsPolicyPpi->MeBiosIntfVer.Minor = 0;

  ///
  /// Update SKU Switch
  ///
  SpsPolicyPpi->SkuSwitch.SiliconEnabled     = TRUE;
  SpsPolicyPpi->SkuSwitch.NodeManagerEnabled = TRUE;

  ///
  /// Update SKU Switch
  ///
  SpsPolicyPpi->MsgSwitch.mPhySurvivability      = TRUE;
  SpsPolicyPpi->MsgSwitch.DramInitDone           = TRUE;
  SpsPolicyPpi->MsgSwitch.MeBiosInterfaceVersion = TRUE;
  SpsPolicyPpi->MsgSwitch.DynamicFusing          = TRUE;
  SpsPolicyPpi->MsgSwitch.IccSetClockEnables     = TRUE;
  SpsPolicyPpi->MsgSwitch.IccSetSpreadSpectrum   = TRUE;
  SpsPolicyPpi->MsgSwitch.HmrfpoGetStatus        = TRUE;
  SpsPolicyPpi->MsgSwitch.HmrfpoLock             = TRUE;
  SpsPolicyPpi->MsgSwitch.HmrfpoEnable           = TRUE;
  SpsPolicyPpi->MsgSwitch.EndOfPost              = TRUE;

  SpsPolicyPpi->MsgSwitch.HostConfiguration      = TRUE;

  ///
  /// Update ICC Clock enables settin
  ///
  ///TODO:  All default. Project need to modify.
  /// ICC_CLOCK_ENABLING in IccPlatformPolicy.h
  ///
  if (SpsPolicyPpi->MsgSwitch.IccSetClockEnables) {
    Data32 = 0;
    Data32 |= SPS_POLICY_ICC_CLOCK_ENABLES_FLEX0;
    Data32 |= SPS_POLICY_ICC_CLOCK_ENABLES_FLEX1;
    Data32 |= SPS_POLICY_ICC_CLOCK_ENABLES_FLEX2;
    Data32 |= SPS_POLICY_ICC_CLOCK_ENABLES_FLEX3;
    Data32 |= SPS_POLICY_ICC_CLOCK_ENABLES_PCICLK0;
    Data32 |= SPS_POLICY_ICC_CLOCK_ENABLES_PCICLK1;
    Data32 |= SPS_POLICY_ICC_CLOCK_ENABLES_PCICLK2;
    Data32 |= SPS_POLICY_ICC_CLOCK_ENABLES_PCICLK3;
    Data32 |= SPS_POLICY_ICC_CLOCK_ENABLES_PCICLK4;
    Data32 |= SPS_POLICY_ICC_CLOCK_ENABLES_SRC0;
    Data32 |= SPS_POLICY_ICC_CLOCK_ENABLES_SRC1;
    Data32 |= SPS_POLICY_ICC_CLOCK_ENABLES_SRC2;
    Data32 |= SPS_POLICY_ICC_CLOCK_ENABLES_SRC3;
    Data32 |= SPS_POLICY_ICC_CLOCK_ENABLES_SRC4;
    Data32 |= SPS_POLICY_ICC_CLOCK_ENABLES_SRC5;
    Data32 |= SPS_POLICY_ICC_CLOCK_ENABLES_SRC6;
    Data32 |= SPS_POLICY_ICC_CLOCK_ENABLES_SRC7;
    Data32 |= SPS_POLICY_ICC_CLOCK_ENABLES_ITPXDP;
    Data32 |= SPS_POLICY_ICC_CLOCK_ENABLES_PEG_A;
    Data32 |= SPS_POLICY_ICC_CLOCK_ENABLES_PEG_B;
//    Data32 |= SPS_POLICY_ICC_CLOCK_ENABLES_DMI;
//    Data32 |= SPS_POLICY_ICC_CLOCK_ENABLES_DP;
//    Data32 |= SPS_POLICY_ICC_CLOCK_ENABLES_DMI2;
//    Data32 |= SPS_POLICY_ICC_CLOCK_ENABLES_DPNS;
//    Data32 |= SPS_POLICY_ICC_CLOCK_ENABLES_PEG_C;
//    Data32 |= SPS_POLICY_ICC_CLOCK_ENABLES_Modulator4Enable;

    SpsPolicyPpi->IccSetting.IccClockEnables.UInt32      = Data32;
    SpsPolicyPpi->IccSetting.IccClockEnablesSkipResponse = SPS_POLICY_ICC_RESPONSE_MODE_WAIT;

    ///
    ///TODO:  All default. Project need to modify.
    ///
    /// When send Clock_EN command, If the response error 0x1A (ICC_STATUS_OCKEN_MASK_VIOLATION),
    /// maybe the ME Fitc tool clock mask sets "adjustment allowed" to FLASE. 
    /// means the BIOS not able to enable/disable clock output.
    ///
    Data32 = 0;
    Data32 |= SPS_POLICY_ICC_CLOCK_ENABLES_FLEX0;
    Data32 |= SPS_POLICY_ICC_CLOCK_ENABLES_FLEX1;
    Data32 |= SPS_POLICY_ICC_CLOCK_ENABLES_FLEX2;
    Data32 |= SPS_POLICY_ICC_CLOCK_ENABLES_FLEX3;
    Data32 |= SPS_POLICY_ICC_CLOCK_ENABLES_PCICLK0;
    Data32 |= SPS_POLICY_ICC_CLOCK_ENABLES_PCICLK1;
    Data32 |= SPS_POLICY_ICC_CLOCK_ENABLES_PCICLK2;
    Data32 |= SPS_POLICY_ICC_CLOCK_ENABLES_PCICLK3;
    Data32 |= SPS_POLICY_ICC_CLOCK_ENABLES_PCICLK4;
    Data32 |= SPS_POLICY_ICC_CLOCK_ENABLES_SRC0;
    Data32 |= SPS_POLICY_ICC_CLOCK_ENABLES_SRC1;
    Data32 |= SPS_POLICY_ICC_CLOCK_ENABLES_SRC2;
    Data32 |= SPS_POLICY_ICC_CLOCK_ENABLES_SRC3;
    Data32 |= SPS_POLICY_ICC_CLOCK_ENABLES_SRC4;
    Data32 |= SPS_POLICY_ICC_CLOCK_ENABLES_SRC5;
    Data32 |= SPS_POLICY_ICC_CLOCK_ENABLES_SRC6;
    Data32 |= SPS_POLICY_ICC_CLOCK_ENABLES_SRC7;
    Data32 |= SPS_POLICY_ICC_CLOCK_ENABLES_ITPXDP;
    Data32 |= SPS_POLICY_ICC_CLOCK_ENABLES_PEG_A;
    Data32 |= SPS_POLICY_ICC_CLOCK_ENABLES_PEG_B;
//    Data32 |= SPS_POLICY_ICC_CLOCK_ENABLES_DMI;
//    Data32 |= SPS_POLICY_ICC_CLOCK_ENABLES_DP;
//    Data32 |= SPS_POLICY_ICC_CLOCK_ENABLES_DMI2;
//    Data32 |=  SPS_POLICY_ICC_CLOCK_ENABLES_DPNS;
//    Data32 |= SPS_POLICY_ICC_CLOCK_ENABLES_PEG_C;
//    Data32 |= SPS_POLICY_ICC_CLOCK_ENABLES_Modulator4Enable;
    SpsPolicyPpi->IccSetting.IccClockEnablesMask.UInt32 = Data32;
  }

  ///
  /// Update ICC Spread spectrum setting
  ///
  ///TODO: Set all SSC to Do not change. Project need to modify.
  /// ICC_CLOCK_ENABLES_MASK in IccPlatformPolicy.h
  ///
  if (SpsPolicyPpi->MsgSwitch.IccSetSpreadSpectrum) {
    SpsPolicyPpi->IccSetting.IccSpreadSpectrumSkipResponse          = SPS_POLICY_ICC_RESPONSE_MODE_WAIT;
    SpsPolicyPpi->IccSetting.IccSpreadSpectrum.Field.SSC1ModeSelect = SPS_POLICY_ICC_SSC_MODE_NOT_CHANGE;
    SpsPolicyPpi->IccSetting.IccSpreadSpectrum.Field.SSC2ModeSelect = SPS_POLICY_ICC_SSC_MODE_NOT_CHANGE;
    SpsPolicyPpi->IccSetting.IccSpreadSpectrum.Field.SSC3ModeSelect = SPS_POLICY_ICC_SSC_MODE_NOT_CHANGE;
    SpsPolicyPpi->IccSetting.IccSpreadSpectrum.Field.SSC4ModeSelect = SPS_POLICY_ICC_SSC_MODE_NOT_CHANGE;
    SpsPolicyPpi->IccSetting.IccSpreadSpectrum.Field.SSC5ModeSelect = SPS_POLICY_ICC_SSC_MODE_NOT_CHANGE;
    SpsPolicyPpi->IccSetting.IccSpreadSpectrum.Field.SSC6ModeSelect = SPS_POLICY_ICC_SSC_MODE_NOT_CHANGE;
    SpsPolicyPpi->IccSetting.IccSpreadSpectrum.Field.SSC7ModeSelect = SPS_POLICY_ICC_SSC_MODE_NOT_CHANGE;
    SpsPolicyPpi->IccSetting.IccSpreadSpectrum.Field.SSC8ModeSelect = SPS_POLICY_ICC_SSC_MODE_NOT_CHANGE;
  }

  ///
  /// Update Host Configuration
  ///
  ///TODO: All Denlow value. Project need to modify.
  ///
  if (SpsPolicyPpi->MsgSwitch.HostConfiguration) {
    SpsPolicyPpi->HostInfo.Capabilities       = SPS_POLICY_HOST_INFO_CAP_TURBO;
    SpsPolicyPpi->HostInfo.PStatesNumber      = 0x10;
    SpsPolicyPpi->HostInfo.TStatesNumber      = 0x10;
    SpsPolicyPpi->HostInfo.MaxPower           = 0x0000;
    SpsPolicyPpi->HostInfo.MinPower           = 0x0000;
    SpsPolicyPpi->HostInfo.ProcNumber         = 0x01;
    SpsPolicyPpi->HostInfo.ProcCoresNumber    = 0x04;
    SpsPolicyPpi->HostInfo.ProcCoresEnabled   = 0x04;
    SpsPolicyPpi->HostInfo.ProcThreadsEnabled = 0x08;
    SpsPolicyPpi->HostInfo.TurboRatioLimit    = 0x0000000023232425;
    SpsPolicyPpi->HostInfo.PlatformInfo       = 0x00080838FF012100;
    SpsPolicyPpi->HostInfo.Altitude           = 0x00000000;
    SpsPolicyPpi->HostInfo.PStatesRatio[0]    = 37;
    SpsPolicyPpi->HostInfo.PStatesRatio[1]    = 33;
    SpsPolicyPpi->HostInfo.PStatesRatio[2]    = 31;
    SpsPolicyPpi->HostInfo.PStatesRatio[3]    = 29;
    SpsPolicyPpi->HostInfo.PStatesRatio[4]    = 28;
    SpsPolicyPpi->HostInfo.PStatesRatio[5]    = 26;
    SpsPolicyPpi->HostInfo.PStatesRatio[6]    = 24;
    SpsPolicyPpi->HostInfo.PStatesRatio[7]    = 22;
    SpsPolicyPpi->HostInfo.PStatesRatio[8]    = 20;
    SpsPolicyPpi->HostInfo.PStatesRatio[9]    = 19;
    SpsPolicyPpi->HostInfo.PStatesRatio[10]   = 17;
    SpsPolicyPpi->HostInfo.PStatesRatio[11]   = 15;
    SpsPolicyPpi->HostInfo.PStatesRatio[12]   = 13;
    SpsPolicyPpi->HostInfo.PStatesRatio[13]   = 12;
    SpsPolicyPpi->HostInfo.PStatesRatio[14]   = 10;
    SpsPolicyPpi->HostInfo.PStatesRatio[15]   = 8;
  }

  ///
  /// Update ME Firmware Upgrade Configure.
  ///
  ///
  /// SPS ME FW Upgrade Settings
  ///
  /// MeFwUpgradeConfig
  ///   |- UpgradeSupported        : enable/disable SPS ME upgrade function
  ///   |- ProtectDescriptorRegion : enable/disable protect descriptor region through SPI protect register with SPS ME firmware production mode
  ///   |- ProtectMeRegion         : enable/disable protect ME region through SPI protect register, except operational partitions.
  ///                                If BIOS needs supporting "safe update entire ME", please disable this.
  ///   |- SpiLock                 : enable/disable lock SPI registers for security
  ///   |- CmosIndexPort           : Index port of CMOS where storing the ME upgraded flag
  ///   |- CmosDataPort            : Data port of CMOS where storing the ME upgraded flag
  ///   |- CmosOffset              : Offset of CMOS where storing the ME upgraded flag
  ///
  SpsPolicyPpi->MeFwUpgradeConfig.UpgradeSupported        = TRUE;
  SpsPolicyPpi->MeFwUpgradeConfig.ProtectDescriptorRegion = FALSE;
  SpsPolicyPpi->MeFwUpgradeConfig.ProtectMeRegion         = FALSE;
  SpsPolicyPpi->MeFwUpgradeConfig.ProtectGbeRegion        = FALSE;
  SpsPolicyPpi->MeFwUpgradeConfig.ProtectPDRRegion        = FALSE;
  SpsPolicyPpi->MeFwUpgradeConfig.ProtectDERRegion        = FALSE;
  SpsPolicyPpi->MeFwUpgradeConfig.SpiLock                 = FALSE;

  SpsPolicyPpi->MeFwUpgradeConfig.CmosIndexPort           = 0x72;
  SpsPolicyPpi->MeFwUpgradeConfig.CmosDataPort            = 0x73;
  SpsPolicyPpi->MeFwUpgradeConfig.CmosOffset              = 0x2D;  ///< MEFlashReset
  SpsPolicyPpi->MeFwUpgradeConfig.FactoryDefaultSize      = 0x00090000;
  SpsPolicyPpi->MeFwUpgradeConfig.OperationImageSize      = 0x00130000;
  SpsPolicyPpi->MeFwUpgradeConfig.BlockMode               = FALSE;
  SpsPolicyPpi->MeFwUpgradeConfig.Downgrade               = TRUE;

  ///
  /// Update mPhy Survivability Table.
  ///
  PchSteppingValue = 0;
  PchSteppingValue = PchStepping();
  switch (PchSteppingValue) {
    case LptHB0:
      SpsPolicyPpi->mPhyTableVer  = *((UINT16*)&PchChipsetInitTableLptH_B0[2]);
      SpsPolicyPpi->mPhyTableLen  = MIN (sizeof (SpsPolicyPpi->mPhyTableData), sizeof (PchChipsetInitTableLptH_B0));
      CopyMem (&SpsPolicyPpi->mPhyTableData[0], &PchChipsetInitTableLptH_B0[0], SpsPolicyPpi->mPhyTableLen);
      break;
    case LptHC0:
    case LptHC1:
    case LptHC2:
      SpsPolicyPpi->mPhyTableVer  = *((UINT16*)&PchChipsetInitTableLptH_Cx_180[2]);
      SpsPolicyPpi->mPhyTableLen  = MIN (sizeof (SpsPolicyPpi->mPhyTableData), sizeof (PchChipsetInitTableLptH_Cx_180));
      CopyMem (&SpsPolicyPpi->mPhyTableData[0], &PchChipsetInitTableLptH_Cx_180[0], SpsPolicyPpi->mPhyTableLen);
      break;
    default:
      DEBUG ((EFI_D_ERROR, "[PEI SPS ME POLICY] INFO: Unsupported PCH Stepping for mPhy Table\n"));
  }

  ///
  /// Build SPS Policy Hob.
  ///
  DEBUG ((DEBUG_INFO, "[PEI SPS ME POLICY] INFO: Build SPS ME Policy Hob.\n"));
  Status = SpsPolicySaveSpsPolicyHob (SpsPolicyPpi);
  if (EFI_ERROR (Status)) {
    DEBUG ((DEBUG_ERROR, "[PEI SPS ME POLICY] ERROR: Build SPS ME Policy Hob => (%r)\n", Status));
  }

  ///
  /// Install ME PEI Platform Policy PPI
  ///
  DEBUG ((DEBUG_INFO, "[PEI SPS ME POLICY] INFO: Installing SPS ME Policy PPI.\n"));
  Status = (**PeiServices).InstallPpi (PeiServices, SpsPolicyPpiDesc);
  if (EFI_ERROR (Status)) {
    DEBUG ((DEBUG_ERROR, "[PEI SPS ME POLICY] ERROR: Installing SPS ME Policy PPI => (%r)\n", Status));
    return Status;
  }

  ///
  /// Dump SPS policy
  ///
  PeiDumpSpsPolicy (SpsPolicyPpi);

  DEBUG ((DEBUG_INFO, "[PEI SPS ME POLICY] INFO: SPS ME Policy PEI Exit\n"));

  return Status;
}
